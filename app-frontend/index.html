<!doctype html>
<html lang="hr">
<head>
<meta charset="utf-8">
<title>Plan&Go</title>
</head>
<body>
<h1>Plan&Go</h1>
<button onclick="loadTrips()">Osvježi listu</button>
<ul id="trips"></ul>

<h2>Novo putovanje</h2>
<input id="title" placeholder="Naziv">
<input id="start" type="date">
<input id="end" type="date">
<button onclick="createTrip()">Spremi</button>

<h2>Dodaj aktivnost</h2>
<input id="tripIdAct" placeholder="Trip ID">
<input id="day" placeholder="Dan">
<input id="actTitle" placeholder="Naslov">
<button onclick="addActivity()">Dodaj</button>
<ul id="acts"></ul>

<h2>Dodaj trošak</h2>
<input id="tripIdExp" placeholder="Trip ID">
<input id="amount" type="number">
<input id="category" placeholder="Kategorija">
<button onclick="addExpense()">Dodaj</button>
<div id="total"></div>

<script>
const API = 'http://localhost:3000';

async function loadTrips(){
  const res = await fetch(API+'/trips'); const trips = await res.json();
  document.getElementById('trips').innerHTML = trips.map(t=>'<li>#'+t.id+' '+t.title+'</li>').join('');
}
async function createTrip(){
  const title=document.getElementById('title').value;
  const start=document.getElementById('start').value;
  const end=document.getElementById('end').value;
  await fetch(API+'/trips',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({title,start,end})});
  loadTrips();
}
async function addActivity(){
  const id=document.getElementById('tripIdAct').value;
  const day=document.getElementById('day').value;
  const title=document.getElementById('actTitle').value;
  const res=await fetch(API+'/trips/'+id+'/activities',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({day,title})});
  const data=await res.json();
  document.getElementById('acts').innerHTML+='<li>'+data.day+' '+data.title+'</li>';
}
async function addExpense(){
  const id=document.getElementById('tripIdExp').value;
  const amount=document.getElementById('amount').value;
  const category=document.getElementById('category').value;
  const res=await fetch(API+'/trips/'+id+'/expenses',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({amount,category})});
  const data=await res.json();
  document.getElementById('total').innerText='Ukupno: '+data.total;
}
</script>
</body>
</html>
